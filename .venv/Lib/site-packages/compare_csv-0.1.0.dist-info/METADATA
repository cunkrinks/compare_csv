Metadata-Version: 2.4
Name: compare-csv
Version: 0.1.0
Summary: Compare two CSV files and export differences using database-style operations.
Project-URL: Homepage, https://example.com/compare-csv
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: pandas>=1.5
Requires-Dist: openpyxl>=3.0

# CSV Table Comparator

Compare two CSV files as database-style tables and generate difference reports.

Features
- Validates both CSVs have the same column set (order may differ) and raises error if not.
- Uses all columns as the default primary key unless `--key` is provided.
- Sorts by key(s) before comparison (deterministic).
- Produces DELETED (in reference A only), INSERTED (in compare-to B only), UPDATED (same keys, different non-key values), and combined status reports.
- Optional: text report and Excel side-by-side output (highlighted differences).

Installation

Create and activate a virtual environment and install dependencies:

```powershell
python -m venv .venv
.\.venv\Scripts\activate
pip install -r requirements.txt
or install locally from source:

pip install .

After installing, run with the 'compare-csv' command:

compare-csv linux.csv Unix.csv --name myrun --report --excel
```

Example CLI usage

```powershell
# Basic comparison, provide a result name (mandatory) and use all columns as primary key:
py compare_csv.py linux.csv Unix.csv --name myrun

# With textual report and Excel side-by-side file; default outdir becomes the value of `--name`
py compare_csv.py linux.csv Unix.csv --name linux_unix --report --excel

# Specify custom key(s)
py compare_csv.py linux.csv Unix.csv --key GRANTEE,OWNER,TABLE_NAME --report
```

Outputs
- `<prefix>_deleted.csv` — rows present only in reference A; columns restored to original names.
- `<prefix>_inserted.csv` — rows present only in compare-to B; columns restored to original names.
- `<prefix>_updated.csv` — rows with same key but different values. Non-key columns contain `_a` and `_b` suffixes for reference and compare-to values.
- `<prefix>_combined.csv` — outer join of both tables with `_merge` and `status` column describing SAME/INSERTED/DELETED/UPDATED.
- `<prefix>_report.txt` — (when `--report`) concise summary and changed fields for UPDATED rows.
- `<prefix>_comparison.xlsx` — (when `--excel`) side-by-side Excel view with updated rows highlighted.

Notes & Tips
- The script uses the larger table as reference by default (it swaps if B has more rows than A).
- The Excel export requires openpyxl. If not installed, run `pip install openpyxl`.
- For very large files, make sure you have enough memory as the tool loads the CSVs using pandas.

Programmatic usage
- See `sample_usage.py` for a programmatic example that calls `compare_csv.main()` from Python.

License
- MIT-style permissive usage for internal tools.
